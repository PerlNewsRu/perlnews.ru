---
tags: windows, perl
author: perlnews
title: Код ошибки Winsock теперь попадает в $^E
---

Давняя история борьбы Perl с кодами ошибок Winsock внезапно получила
продолжение. Как известно, традиционно в Perl на Windows коды ошибок Winsock
сохранялись в `errno` и транслировались в переменную `$!` так, чтобы
соответствовать POSIX-кодам ошибок. Возникающие проблемы при таком подходе уже
подробно освещались в статье [«AnyEvent сломан на Strawberry
Perl 5.20»](http://perlnews.ru/blog/2015/03/16/01-anyevent-broken-on-windows-perl.html)

И вот, в конце февраля было внесено новое
[предложение](http://www.nntp.perl.org/group/perl.perl5.porters/2016/02/msg234472.html)
по работе с ошибками Winsock. Чтобы немного смягчить имеющееся рассогласование,
начиная с грядущего выпуска Perl 5.24 значение кода ошибки Winsock будет
попадать в переменную `$^E`, которая как раз и служит для хранения
платформо-специфичных ошибок. Отказ от модификации `$!` пока не
предусматривается, но если он будет выполнен для Winsock, то пройдёт через
стандартную схему устаревания и, как минимум, через один стабильный релиз.

11 марта это
[изменение](http://perl5.git.perl.org/perl.git/commitdiff/22e30cb2a3fd49a3d6fe5a866b28ff36608340ae)
было отправлено в основную ветку.

